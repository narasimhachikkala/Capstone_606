# 1. Road Accident Severity Prediction
- Prepared for UMBC Data Science Master Degree Capstone by Dr Chaoji (Jay) Wang 
- Author: CHIKKALA PS ManikantaVijayaSri NarasimhaNaidu, UMBC, Fall-2023 Semester
- GitHub Link: https://github.com/narasimhachikkala
- LinkedIn profile: https://www.linkedin.com/in/narasimha-naidu-chikkala
- youtube link:
- PPT Link: 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
## 2. Background
The project is about predicting the severity of road accidents in a specific region. It accomplishes this by analyzing historical data related to road accidents in that region. The project involves training a predictive model using the historical accident data. Once the model is trained, it can be used to make predictions about the severity of accidents when given new input data, such as information about a recent accident. In essence, this project aims to create a tool or system that can assess and predict the level of severity for road accidents based on historical patterns and data analysis, potentially aiding in better accident prevention and response efforts in the specified region. This project matters because it has the potential to improve road safety, save lives, optimize resource allocation, and contribute to more effective accident prevention and response strategies in the specified region.

#### Research Questions :
1. What temporal or seasonal trends exist in accident severity within the target  region, and how can these patterns be incorporated into the predictive analysis? 

2. Which specific factors exhibit the greatest influence on road accident severity within the target region, and how can this understanding inform the predictive modeling process?

3. Based on the predictions generated by the model, what actionable interventions and preventive measures can be recommended to mitigate road accident severity in the target region, and how can these recommendations be effectively implemented?
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
## 3. Data

Description : This dataset reports details of all traffic collisions occurring on county and local roadways within Montgomery County, of the Maryland State from 2015 to September 2023. Each row consists details about crash report.

**3.1 Data Source** : *[dataset](https://catalog.data.gov/dataset/crash-reporting-drivers-data)*. :link:

   Data Size : 79 MB

**3.2 Data Shape**
   > - Number of columns =  43
   > - Number of rows    = 164,926

**3.3 Data dictionary:**
   
| Column Name | Description                                                                                      | Data Type        | Potential Values  |
|----------------------------| :--------------------------------------------------------------------------------------------------:|:------------------:|:-------------------:|
| Report Number              | A unique identifier for the accident report.                                                      | Object           | MCP3040003N                 |
| Local Case Number          | A local reference number or identifier for the specific accident case.                              | Object           | 190026050                 |
| Agency Name                | The name of the agency or organization responsible for reporting and handling the accident data.    | Object           | Montgomery County Police                 |
| ACRS Report Type           | The type or format of the accident report (e.g., official accident report, summary report, etc.).   | Object           | Property Damage,Injury crasg=h, Fatal crash                 |
| Crash Date/Time            | The date and time when the accident occurred.                                                       | Object           | 07/13/2023 05:40:00 PM                 |
| Route Type                 | The type of road or route where the accident took place (e.g., highway, street, etc.).                | Object           | Municipality, Maryland(state),County                 |
| Road Name                  | The name of the road where the accident occurred.                                                     | Object           | Selfridge rd, Perry pkwy                 |
| Cross-Street Type          | The type of intersecting road (e.g., street, avenue, etc.).                                           | Object           | County                 |
| Cross-Street Name          | The name of the intersecting road.                                                                   | Object           | Randolph Rd, Shady grove Rd                 |
| Off-Road Description       | A description of the accident's location in relation to the road (e.g., on a shoulder, in a parking lot, etc.). | Object       | Parking lot of 3215 spartan rd                 |
| Municipality               | The city or municipality where the accident occurred.                                                  | Object           | Gaithersburg                 |
| Related Non-Motorist       | Any non-motorist involved in the accident (e.g., pedestrians, cyclists).                                | Object           | Bicyclist                 |
| Collision Type             | The type of collision that occurred (e.g., rear-end, head-on, sideswipe).                                 | Object           | Same dir rear end, head on, other                 |
| Weather                    | The weather conditions at the time of the accident (e.g., rainy, sunny, foggy).                           | Object           | Clear, cloudy                 |
| Surface Condition          | The road surface condition (e.g., dry, wet, icy).                                                         | Object           | dry, wet                 |
| Light                      | The lighting conditions at the time of the accident (e.g., daylight, dark, dusk).                         | Object           | daylight, dusk                 |
| Traffic Control            | Information about traffic control devices at the accident site (e.g., traffic signal, stop sign).           | Object           | Traffic signals, no controls                |
| Driver Substance Abuse     | Whether the driver was under the influence of substances (e.g., alcohol, drugs).                           | Object           | None Detected, alcohol present          |
| Non-Motorist Substance Abuse | Whether a non-motorist involved in the accident was under the influence of substances.                    | Object        | None Detected, alcohol present           |
| Person ID                  | A unique identifier for individuals involved in the accident.                                             | Object           | DE2A24CD-7919-4F8D-BABF-5B75CE12D21E                 |
| Driver At Fault            | Whether the driver was deemed at fault for the accident.                                                   | Object           | Yes, No           |
| Injury Severity            | The severity of injuries sustained by individuals involved in the accident (e.g., minor, serious, fatal).  | Object           | No apparent injury, suspected minor injury |
| Circumstance               | Additional circumstances or factors related to the accident.                                               | Object           | Animal                |
| Driver Distracted By       | What distracted the driver, if applicable.                                                               | Object           | not distracted, looked but did not see                  |
| Drivers License State      | The state where the driver's license was issued.                                                          | Object           | MD,CA                 |
| Vehicle ID                 | A unique identifier for vehicles involved in the accident.                                                 | Object           | 165AD539-A8C8-4004-AF73-B7DCAAA8B3CC                 |
| Vehicle Damage Extent      | The extent of damage to the vehicle (e.g., minor, moderate, severe).                                       | Object           | SUPERFICIAL,FUNCTIONAL |
| Vehicle First Impact Location | The location on the vehicle where the first impact occurred.                                              | Object         | ONE OCLOCK,SEVEN OCLOCK                 |
| Vehicle Second Impact Location | The location on the vehicle where the second impact occurred.                                            | Object         | ONE OCLOCK,SEVEN OCLOCK                 |
| Vehicle Body Type          | The type of vehicle body (e.g., sedan, SUV, truck).                                                       | Object           | PASSENGER CAR,(SPORT) UTILITY VEHICLE                 |
| Vehicle Movement           | The movement or action of the vehicle at the time of the accident.                                        | Object           | PARKING,MOVING                 |
| Vehicle Continuing Dir     | The direction in which the vehicle continued after the accident.                                          | Object           | North,South                 |
| Vehicle Going Dir          | The direction the vehicle was heading before the accident.                                                | Object           | North,South                 |
| Speed Limit                | The posted speed limit on the road where the accident occurred.                                           | Int64            | 15,0,30                 |
| Driverless Vehicle         | Indicates if a driverless (autonomous) vehicle was involved.                                              | Object           | Yes, No           |
| Parked Vehicle             | Indicates if a parked vehicle was involved.                                                               | Object           | Yes, No           |
| Vehicle Year               | The year the vehicle was manufactured.                                                                   | Int64            | 2003,2004                 |
| Vehicle Make               | The make or manufacturer of the vehicle.                                                                 | Object           | HONDA, UNK, FORD                 |
| Vehicle Model              | The model of the vehicle.                                                                                 | Object           | TK,UNK                 |
| Equipment Problems         | Any equipment or vehicle problems noted.                                                                  | Object           | -                 |
| Latitude                   | The geographical latitude coordinate of the accident location.                                            | Float            | 39.15004368                 |
| Longitude                  | The geographical longitude coordinate of the accident location.                                           | Float            |  -77.06308884               |
| Location                   | A general description of the accident location.                                                           | Object           | (39.15004368, -77.06308884)                 |



**3.4 Which variable/column will be your target/label in your ML model?**
    - Injury Severity

      It can Classified into:
      
         - NO APPARENT INJURY          
         - POSSIBLE INJURY              
         - SUSPECTED MINOR INJURY       
         - SUSPECTED SERIOUS INJURY     
         - FATAL INJURY                   

**3.5. Which variables/columns may selected as features/predictors for your ML models?**
   - Since there are too many features and adding all the features will increase noise in the model so the features are selected after performing the basic EDA and applying feature selection algos (PCA, dimensionality reduction, selectKbest).

## 4. EDA
### 4.1 Checking the Null values
- I checked for the Null values in all columns I found that are there are more null values for the columns like Off-Road Description, Municipality,
and Related Non-Motorist these colums are removed from the dataset as the weightage of these columns doesn't affect the prediction.
### 4.2 Filling the Null values
- Filled the nulls in some columns which are required for the prediction.
### 4.3 Data Cleansing and Data Visualization
- Performed Data Cleansing as there are more nulls in some columns.
- Initially, I removed some columns like Report_Number, Person_ID and others as they don't have more impact in our prediction. But these columns may be used later depending on the evaluation metrics of the model.
- This is an Multiclass classification problem. So, Assigned 0,1,2,3,4 values to the target variable.
- Next, I did One-Hot Encoding to convert categorical variables into a numerical format.
- I also Standardized latitude and longitude using StandardScaler which improve the stability, and interpretability.
- Moving to Data Visualization, I plotted some graphs using plotly which are neccessary for the analysis
#### 4.3.1 Injury Severity for Each month
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/bb0307cd-90ef-4123-ac17-c5c3b4028056">

#### 4.3.2 Accidents recorded each month
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/1dcc37c8-f092-4f37-aad0-cdeff44084d2">
 
 #### 4.3.3 Accidents recorded each year
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/aa9b9134-e5be-465b-b608-7c7fd2093cf3">

 #### 4.3.4 Avg number of accidents recorded from jan-june (first half) and july- dec (second half)
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/35bc1f07-655f-4bc1-ba28-0ee5faab60ca">

 #### 4.3.5 Accidents by Weather
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/67be30b5-09bf-433c-af98-ac2aac3e7ce9">

 #### 4.3.6 Surface Conditions for Accidents
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/3bbc2723-53a7-4f32-aff7-75e6a4e55b08">

 #### 4.3.7 Count of Injury Severity by Agency Names
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/d14d818b-a7a2-4af5-a396-bc8a2b002c47">

 #### 4.3.8 Total Accidents Reported in Daylight vs. Night
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/a7a30117-a29c-4dc2-b5e1-90aa04a89d2e">

 #### 4.3.9 Accidents by Day/Night per Year
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/f669981e-d635-460d-9891-09582c1293e7">

 #### 4.3.10 Number of Accidents vs. Speed Limit (Year-wise)
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/357a6be7-5d29-4a68-8f59-504b0fa715ac">

### Interpretations
- Number of accidents got decreased during the COVID period 2019-2020 and catched an upward trend after that till 2022
- Most accidents happen in the second half of the year that is during winters (sept-dec) and in Montgomery County region.
- Most of the accidents happened in the daylight. Based on this we can say more people travel on day than night.
- Most of the accidents happened when the weather is clear and road surface is dry.
- Most of the accidents happened within the speed limits of 25-40 MPH.
- Most of the accidents are no apparent injury.

## 5. Model Training
- Splitting the data into 80 - 20 for training and testing.
- Applied SMOTE (Synthetic Minority oversampling technique) on training data to balance the data.
- Performed the feature selection using SelectKBest method with the f_classif scoring function.
- The Features I got from SelectKBest are: 'Driver_Substance_Abuse_NONE DETECTED', 'Driver_Substance_Abuse_UNKNOWN', 'Driver_At_Fault_No', 'Driver_At_Fault_Yes', 'Driver_Distracted_By_NOT DISTRACTED', 'Driver_Distracted_By_UNKNOWN', 'Vehicle_Damage_Extent_DESTROYED', 'Vehicle_Damage_Extent_FUNCTIONAL', 'Vehicle_Damage_Extent_SUPERFICIAL', 'Equipment_Problems_NO MISUSE'
- Employing a variety of models to generate predictions involves leveraging different algorithms or approaches to analyze and interpret data for forecasting purposes.
- It encompasses the utilization of diverse modeling techniques to enhance the robustness and reliability of predictions, thereby broadening the scope of methodologies applied for generating accurate and comprehensive results.
  
## 5.1 Random Forest Classifier 
- I used Random Forest Classifier for my initial prediction.
- Obtained the accuracy of 0.665 using Random Forest Classifier.
  
<img width="1072" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/e14ecc12-6108-4dce-85a9-c4e12ce47c36">


## Re-evaluation of features by selecting manually
- I manually chose specific features for prediction in order to assess whether this selection would contribute to increased accuracy in the model.
- By personally curating the features, I aim to evaluate their impact on the predictive capabilities of the model and determine if this tailored approach enhances overall accuracy.
  
<img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/88262df1-f5ec-4d03-b78f-7977bb4a383a">

## 5.2 Random Forest Classifier using selected_feature_names
- I employed a Random Forest Classifier for the chosen features.
- The figure demonstrates an increase in accuracy, reaching 74%.
  
<img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/1ce23d2e-2d93-473a-b281-2a2d57493e4b">


## 5.3 XGBClassifier
- Subsequently, I opted for the XGBClassifier in an attempt to enhance the accuracy of my predictions.
- This decision reflects a deliberate effort to explore alternative modeling techniques and leverage the strengths of the XGBoost algorithm, aiming to achieve improved precision and reliability in the predictive outcomes.
- The utilization of XGBClassifier to refine the predictive model and further optimize its performance for more accurate results.
- The XGBClassifier yielded an accuracy rate of 68%.
  
  <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/225ea08e-9fc7-4cad-aeed-04223dd68f88">

## 5.4 DecisionTreeClassifier
- Following that, I decided to employ a Decision Tree model.
- By incorporating a Decision Tree into the predictive modeling process, I sought to evaluate its efficacy and assess whether this algorithm could contribute positively to the overall accuracy of the predictions.
- This step reflects a systematic exploration of different modeling approaches to identify the most suitable one for achieving optimal results in the prediction task at hand.
- The Decision Tree Classifier yielded an accuracy rate of 68%, indicating the model's proficiency in correctly predicting outcomes based on the selected features.
  
<img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/716a1311-4a7a-4e6e-a94f-019c9b374bf9"> <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/f5838343-25ae-47e7-b912-9ba1d8deabc9">

## 5.5 Ensemble Modelling
- Lastly, I ventured into ensemble modeling.
- This approach involves combining the predictions from multiple models to create a more robust and accurate overall prediction.
- By leveraging ensemble techniques, such as boosting, I aimed to harness the strengths of diverse models and mitigate individual weaknesses, ultimately enhancing the predictive performance.
- Ensemble modeling represents a culmination of efforts to optimize accuracy by capitalizing on the complementary nature of various algorithms, contributing to a more comprehensive and reliable prediction framework.
  
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/a89c012d-ff3b-4424-be1e-af445bfd9b49"> <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/26bdc513-d39e-4730-b346-9ca489344c3c">

## saving the models
<img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/31ec5468-697f-4625-a104-9882000092ff">

## 6. Web Application Using Flask
<img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/6fad89da-5ab3-4d5f-90d0-007f0657e259">

## 7. conclusion

- Number of accidents got decreased during the COVID period 2019-2020 and moved an upward trend after that till 2022.
- Most accidents happen in the second half of the year that is during winters (sept-dec).
- Most of the accidents happened in the daylight.
- Most accidents happened when the weather is clear and road surface is dry.
- Most of the accidents happened within the speed limits of 25-40 MPH.
- Most of the accident’s prediction comes out as no apparent injury.
- High accuracy is obtained from the random forest model

## 8. Future work
- Experiment with advanced machine learning algorithms beyond decision trees, such as neural networks and systematically tune hyperparameters for optimal performance. 
- Validating with robust cross-validation methods and evaluating beyond accuracy metrics will provide a nuanced understanding of the model's performance.
- Collaborate with stakeholders, including transportation authorities, to align the model with practical needs. Establish continuous monitoring systems and feedback loops to ensure ongoing accuracy and relevance.

## References
-  Data Source : Crash Reporting - Drivers Data (2015 - 2023) | Montgomery county, Maryland. (https://catalog.data.gov/dataset/crash-reporting-drivers-data)
- https://plotly.com/python-api-reference/
- https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/
- https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html
- https://pythonbasics.org/what-is-flask-python/
